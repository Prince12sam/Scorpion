# ü§ñ AI-Powered Penetration Testing Guide

## Complete Guide to Autonomous Security Testing with Scorpion

**Version:** 2.1.0  
**Last Updated:** December 10, 2025  
**Status:** ‚úÖ Production Ready

---

## ‚ö†Ô∏è CRITICAL LEGAL WARNING

**AI-powered penetration testing is EXTREMELY POWERFUL and potentially DANGEROUS.**

### Legal Requirements

üö® **YOU MUST HAVE EXPLICIT WRITTEN AUTHORIZATION** to test any target system.

**Unauthorized penetration testing is ILLEGAL and may result in:**
- Criminal prosecution under computer fraud laws (CFAA in USA, Computer Misuse Act in UK, etc.)
- Significant financial penalties (up to $500,000+ in fines)
- Imprisonment (up to 10 years in some jurisdictions)
- Civil liability and lawsuits
- Professional license revocation
- Permanent criminal record

### Authorization Checklist

Before running AI pentesting:
- ‚úÖ Written authorization from system owner
- ‚úÖ Defined scope of testing (specific targets, systems, timeframes)
- ‚úÖ Rules of engagement documented
- ‚úÖ Emergency contact information
- ‚úÖ Legal review completed
- ‚úÖ Insurance coverage verified (if applicable)

**If you cannot check ALL boxes above, DO NOT PROCEED.**

---

## üìã Table of Contents

1. [Overview](#overview)
2. [How It Works](#how-it-works)
3. [AI Providers & Setup](#ai-providers--setup)
4. [Quick Start](#quick-start)
5. [Configuration Options](#configuration-options)
6. [Usage Examples](#usage-examples)
7. [Primary Goals](#primary-goals)
8. [Autonomy Levels](#autonomy-levels)
9. [Risk Tolerance](#risk-tolerance)
10. [Stealth Levels](#stealth-levels)
11. [Understanding Results](#understanding-results)
12. [Best Practices](#best-practices)
13. [Troubleshooting](#troubleshooting)
14. [API Provider Details](#api-provider-details)
15. [Cost Considerations](#cost-considerations)
16. [Limitations](#limitations)
17. [FAQ](#faq)

---

## Overview

### What is AI-Powered Penetration Testing?

Scorpion's AI pentesting agent uses Large Language Models (LLMs) to intelligently orchestrate security testing. Instead of running predefined scripts, the AI:

1. **Analyzes findings** from each test
2. **Decides the next action** based on your goal
3. **Chains tools strategically** to achieve objectives
4. **Adapts to discoveries** in real-time
5. **Learns from results** to optimize testing

### Key Features

‚úÖ **Intelligent Tool Selection** - AI chooses optimal tools for the situation  
‚úÖ **Adaptive Testing** - Adjusts strategy based on findings  
‚úÖ **Goal-Oriented** - Focuses on your primary objective  
‚úÖ **Multi-Provider Support** - Works with OpenAI, Anthropic, custom endpoints  
‚úÖ **Safety Controls** - Built-in risk management and authorization checks  
‚úÖ **Comprehensive Reporting** - Detailed findings with AI-generated recommendations  

### Available Tools (Orchestrated by AI)

The AI can use these Scorpion tools:
- **port_scan** - Discover open ports and services
- **syn_scan** - Stealthy SYN scanning (requires admin/root)
- **ssl_analyze** - Analyze SSL/TLS certificates and vulnerabilities
- **os_fingerprint** - Identify operating system
- **web_pentest** - Test for web vulnerabilities (SQL injection, XSS, SSRF, etc.)
- **api_test** - Test API security
- **takeover_scan** - Check for subdomain takeover
- **tech_detect** - Identify technologies and frameworks
- **recon** - DNS enumeration, WHOIS, reconnaissance
- **payload_generate** - Generate exploitation payloads (HIGH risk only)

---

## How It Works

### Architecture

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    AI Pentest Agent                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                         ‚îÇ
‚îÇ  1. Start ‚Üí Define Goal & Parameters                   ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  2. AI Decision Loop:                                  ‚îÇ
‚îÇ     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îÇ
‚îÇ     ‚îÇ  a) Analyze current findings         ‚îÇ          ‚îÇ
‚îÇ     ‚îÇ  b) Consult AI for next action       ‚îÇ          ‚îÇ
‚îÇ     ‚îÇ  c) Execute tool                     ‚îÇ          ‚îÇ
‚îÇ     ‚îÇ  d) Record findings                  ‚îÇ          ‚îÇ
‚îÇ     ‚îÇ  e) Check if goal achieved           ‚îÇ          ‚îÇ
‚îÇ     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îÇ
‚îÇ            ‚Üì Repeat until done                         ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ  3. Generate Report ‚Üí AI Recommendations               ‚îÇ
‚îÇ                                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Workflow

1. **Initialization**: Agent starts with your target and goal
2. **AI Consultation**: Agent asks AI what to do next
3. **Action Execution**: Runs the chosen tool (port scan, web test, etc.)
4. **Finding Analysis**: Records results and extracts insights
5. **Decision Loop**: Repeats until goal achieved or time limit reached
6. **Report Generation**: Creates comprehensive report with recommendations

### AI Decision Making

The AI considers:
- **Current findings** (what's been discovered)
- **Previous actions** (what's been tried)
- **Primary goal** (what you want to achieve)
- **Risk tolerance** (what's allowed)
- **Stealth level** (how noisy to be)
- **Time remaining** (efficiency)
- **Best practices** (security testing methodology)

---

## AI Providers & Setup

### Supported Providers

1. **OpenAI** (GPT-4, GPT-3.5-turbo)
2. **Anthropic** (Claude 3 Opus, Sonnet, Haiku)
3. **Custom** (Any OpenAI-compatible endpoint)

### Getting API Keys

#### OpenAI

1. Go to https://platform.openai.com/api-keys
2. Create account / sign in
3. Click "Create new secret key"
4. Copy key (starts with `sk-...`)
5. Set environment variable:

```bash
# Linux/Mac
export SCORPION_AI_API_KEY='sk-...'

# Windows PowerShell
$env:SCORPION_AI_API_KEY='sk-...'

# Windows CMD
set SCORPION_AI_API_KEY=sk-...
```

**Recommended Models:**
- `gpt-4` - Best quality, highest cost ($0.03/1K tokens)
- `gpt-4-turbo` - Fast and capable ($0.01/1K tokens)
- `gpt-3.5-turbo` - Budget option ($0.0015/1K tokens)

#### Anthropic

1. Go to https://console.anthropic.com/
2. Create account / sign in
3. Navigate to API Keys
4. Create new key
5. Copy key (starts with `sk-ant-...`)
6. Set environment variable:

```bash
export SCORPION_AI_API_KEY='sk-ant-...'
```

**Recommended Models:**
- `claude-3-opus-20240229` - Best quality, highest cost
- `claude-3-sonnet-20240229` - Balanced performance
- `claude-3-haiku-20240307` - Fast and economical

#### Custom / Local Models

For local models (Ollama, LM Studio, etc.) or custom endpoints:

```bash
scorpion ai-pentest -t example.com \
  --ai-provider custom \
  --api-endpoint http://localhost:11434/v1/chat/completions \
  --api-key local \
  --model llama3
```

---

## Quick Start

### 1. Set API Key

```bash
# Linux/Mac
export SCORPION_AI_API_KEY='sk-...'

# Windows PowerShell
$env:SCORPION_AI_API_KEY='sk-...'
```

### 2. Run Basic AI Pentest

```bash
scorpion ai-pentest -t example.com
```

### 3. View Results

Results saved automatically to: `ai_pentest_example.com_TIMESTAMP.json`

---

## Configuration Options

### Command Syntax

```bash
scorpion ai-pentest -t TARGET [OPTIONS]
```

### Required Options

| Option | Description | Example |
|--------|-------------|---------|
| `-t, --target` | Target system (IP, domain) | `-t example.com` |

### AI Provider Options

| Option | Description | Default | Example |
|--------|-------------|---------|---------|
| `--ai-provider` | AI provider (openai, anthropic, custom) | `openai` | `--ai-provider anthropic` |
| `--api-key` | API key (or use env var) | `$SCORPION_AI_API_KEY` | `--api-key sk-...` |
| `--model` | AI model name | `gpt-4` | `--model gpt-3.5-turbo` |
| `--api-endpoint` | Custom endpoint URL | None | `--api-endpoint http://localhost:1234/v1/chat/completions` |

### Testing Configuration

| Option | Description | Default | Example |
|--------|-------------|---------|---------|
| `--primary-goal` | Main objective | `comprehensive_assessment` | `--primary-goal web_exploitation` |
| `--secondary-goals` | Additional goals (comma-separated) | None | `--secondary-goals "privilege_escalation,data_access"` |
| `--time-limit` | Max duration (minutes) | `120` | `--time-limit 60` |
| `--stealth-level` | Noise level (low/moderate/high) | `moderate` | `--stealth-level high` |
| `--autonomy` | Automation level | `semi_autonomous` | `--autonomy supervised` |
| `--risk-tolerance` | Risk level (low/medium/high) | `medium` | `--risk-tolerance high` |
| `--max-iterations` | Max AI decision loops | `10` | `--max-iterations 20` |

### Output Options

| Option | Description | Example |
|--------|-------------|---------|
| `-o, --output` | Output file path | `-o report.json` |
| `--learning-mode` | Enable learning (future feature) | `--learning-mode` |

---

## Usage Examples

### Basic Examples

#### 1. Comprehensive Assessment (Default)

```bash
scorpion ai-pentest -t example.com --api-key sk-...
```

**What it does:**
- Full reconnaissance
- Port scanning
- Web vulnerability testing
- SSL/TLS analysis
- Technology detection

#### 2. Quick Scan (Budget-Friendly)

```bash
scorpion ai-pentest -t example.com \
  --model gpt-3.5-turbo \
  --time-limit 30 \
  --max-iterations 5
```

**Cost:** ~$0.10-0.50

#### 3. High Stealth Assessment

```bash
scorpion ai-pentest -t example.com \
  --stealth-level high \
  --time-limit 180
```

**Characteristics:**
- Slow, careful scanning
- Low concurrency
- Mimics normal traffic

### Advanced Examples

#### 4. Web Application Focus

```bash
scorpion ai-pentest -t https://example.com \
  --primary-goal web_exploitation \
  --risk-tolerance medium \
  --time-limit 90
```

**Focus areas:**
- SQL injection
- XSS vulnerabilities
- SSRF testing
- Security headers
- CORS misconfigurations

#### 5. Network Infrastructure Assessment

```bash
scorpion ai-pentest -t 192.168.1.1 \
  --primary-goal network_mapping \
  --stealth-level low \
  --time-limit 60
```

**Activities:**
- Aggressive port scanning
- OS fingerprinting
- Service version detection
- Network topology mapping

#### 6. Privilege Escalation Search

```bash
scorpion ai-pentest -t example.com \
  --primary-goal privilege_escalation \
  --risk-tolerance high \
  --autonomy semi_autonomous
```

**Includes:**
- Full reconnaissance
- Vulnerability assessment
- Payload generation (if authorized)
- Exploitation vectors identification

#### 7. Anthropic Claude (High Quality)

```bash
scorpion ai-pentest -t example.com \
  --ai-provider anthropic \
  --api-key sk-ant-... \
  --model claude-3-opus-20240229
```

**Benefits:**
- Superior reasoning
- Better contextual understanding
- More strategic decisions

#### 8. Local AI Model (Privacy)

```bash
# Using Ollama locally
scorpion ai-pentest -t example.com \
  --ai-provider custom \
  --api-endpoint http://localhost:11434/v1/chat/completions \
  --api-key local \
  --model llama3
```

**Advantages:**
- No data sent to third parties
- No API costs
- Unlimited usage

#### 9. Supervised Mode (Full Control)

```bash
scorpion ai-pentest -t example.com \
  --autonomy supervised \
  --risk-tolerance low
```

**Behavior:**
- Prompts before EVERY action
- User approves each step
- Maximum safety

#### 10. Fully Autonomous (Dangerous)

```bash
scorpion ai-pentest -t example.com \
  --autonomy fully_autonomous \
  --risk-tolerance high \
  --time-limit 240
```

**‚ö†Ô∏è WARNING:**
- Runs without user approval
- May attempt exploitation
- Requires explicit authorization
- Use only in controlled environments

---

## Primary Goals

### comprehensive_assessment (Default)

**Description:** Full security assessment covering all areas

**AI Strategy:**
1. Reconnaissance (recon, tech_detect)
2. Port scanning (port_scan, syn_scan)
3. SSL/TLS analysis (ssl_analyze)
4. OS fingerprinting (os_fingerprint)
5. Web testing (web_pentest, api_test)
6. Subdomain checks (takeover_scan)

**Best For:**
- Initial security assessments
- Broad vulnerability discovery
- Compliance testing
- Regular security audits

**Time Required:** 60-180 minutes

---

### privilege_escalation

**Description:** Focus on finding privilege escalation paths

**AI Strategy:**
1. OS detection
2. Service enumeration
3. Vulnerability mapping
4. Exploit identification
5. Payload generation (if authorized)

**Best For:**
- Post-exploitation scenarios
- Internal penetration tests
- Red team engagements

**Time Required:** 30-90 minutes

---

### data_access

**Description:** Focus on finding data exposure vulnerabilities

**AI Strategy:**
1. API endpoint discovery
2. Authentication bypass testing
3. IDOR (Insecure Direct Object Reference) testing
4. SQL injection testing
5. SSRF for internal access

**Best For:**
- Data security assessments
- Privacy compliance testing
- API security audits

**Time Required:** 45-120 minutes

---

### network_mapping

**Description:** Comprehensive network discovery and mapping

**AI Strategy:**
1. Port scanning (all ports)
2. Service version detection
3. OS fingerprinting
4. Network topology mapping
5. Technology identification

**Best For:**
- Infrastructure assessments
- Network security audits
- Attack surface mapping

**Time Required:** 30-60 minutes

---

### web_exploitation

**Description:** Deep web application vulnerability testing

**AI Strategy:**
1. Web crawling
2. Input point identification
3. SQL injection testing
4. XSS testing
5. Command injection testing
6. SSRF testing
7. XXE testing

**Best For:**
- Web application pentests
- OWASP Top 10 testing
- Bug bounty hunting

**Time Required:** 60-180 minutes

---

## Autonomy Levels

### supervised (Safest)

**Behavior:**
- Prompts before EVERY action
- User reviews and approves each step
- Maximum control and oversight

**Use Cases:**
- Learning how AI pentesting works
- High-risk targets
- Compliance requirements
- Training scenarios

**Pros:**
- Full control
- No surprises
- Educational value

**Cons:**
- Slow execution
- Requires constant attention
- Not truly autonomous

---

### semi_autonomous (Recommended)

**Behavior:**
- Executes low/medium risk actions automatically
- Prompts for HIGH risk actions
- Balanced approach

**Use Cases:**
- Most penetration tests
- Regular security assessments
- Authorized testing with oversight

**Pros:**
- Good balance of speed and safety
- Prevents dangerous actions
- Reasonable execution time

**Cons:**
- May still require some interaction
- Not fully hands-off

---

### fully_autonomous (Dangerous)

**Behavior:**
- Executes ALL actions without confirmation
- No user interaction required
- Potentially performs exploitation

**Use Cases:**
- Controlled lab environments
- Automated CI/CD security testing
- Fully authorized engagements

**Pros:**
- Truly autonomous
- Fast execution
- Hands-off operation

**Cons:**
- ‚ö†Ô∏è **VERY DANGEROUS**
- May attempt exploitation
- Requires explicit authorization
- Legal risks if misused

**‚ö†Ô∏è WARNING:** Only use with explicit written authorization!

---

## Risk Tolerance

### low (Passive Only)

**Allowed Actions:**
- Reconnaissance (DNS, WHOIS)
- Technology detection
- Public information gathering
- Passive SSL analysis

**NOT Allowed:**
- Active scanning
- Vulnerability testing
- Exploitation attempts

**Use Cases:**
- OSINT gathering
- Pre-engagement reconnaissance
- Ultra-safe assessments

---

### medium (Active Scanning)

**Allowed Actions:**
- Port scanning
- Service detection
- Vulnerability scanning
- Web application testing
- API testing

**NOT Allowed:**
- Exploitation attempts
- Payload generation
- Brute force attacks

**Use Cases:**
- Standard penetration tests
- Vulnerability assessments
- Most security audits

---

### high (Full Exploitation)

**Allowed Actions:**
- ALL medium risk actions
- Payload generation
- Exploitation attempts
- Post-exploitation actions

**‚ö†Ô∏è Requirements:**
- Explicit written authorization
- Defined scope
- Legal review completed

**Use Cases:**
- Red team engagements
- Full penetration tests
- Authorized exploitation testing

---

## Stealth Levels

### low (Fast & Noisy)

**Characteristics:**
- High concurrency (100+ simultaneous requests)
- Fast port scanning
- Aggressive testing
- May trigger IDS/IPS

**Speed:** Fast (15-30 min for comprehensive test)

**Detection Risk:** High

**Use Cases:**
- Internal network testing
- Lab environments
- Quick assessments
- Speed-critical scenarios

---

### moderate (Balanced)

**Characteristics:**
- Medium concurrency (20-50 requests)
- Normal scanning speed
- Balanced approach
- Some IDS/IPS alerts possible

**Speed:** Medium (30-90 min for comprehensive test)

**Detection Risk:** Medium

**Use Cases:**
- Most penetration tests
- Standard security assessments
- Reasonable compromise

---

### high (Slow & Stealthy)

**Characteristics:**
- Low concurrency (5-10 requests)
- Slow scanning with delays
- Mimics normal traffic
- Minimal IDS/IPS alerts

**Speed:** Slow (90-180 min for comprehensive test)

**Detection Risk:** Low

**Use Cases:**
- Red team engagements
- IDS/IPS evasion testing
- Sensitive targets
- Covert assessments

---

## Understanding Results

### Report Structure

```json
{
  "summary": {
    "target": "example.com",
    "primary_goal": "comprehensive_assessment",
    "start_time": "2025-12-10T10:00:00",
    "end_time": "2025-12-10T11:30:00",
    "duration_minutes": 90,
    "iterations": 8,
    "total_findings": 15,
    "total_actions": 8,
    "ai_provider": "openai",
    "ai_model": "gpt-4"
  },
  "findings_by_severity": {
    "critical": 1,
    "high": 3,
    "medium": 5,
    "low": 4,
    "info": 2
  },
  "detailed_findings": [...],
  "actions_taken": [...],
  "recommendations": [...]
}
```

### Severity Levels

| Severity | Description | Action Required |
|----------|-------------|-----------------|
| **CRITICAL** | Immediate exploitation possible | Fix IMMEDIATELY (within 24 hours) |
| **HIGH** | Significant security risk | Fix within 1 week |
| **MEDIUM** | Moderate security concern | Fix within 1 month |
| **LOW** | Minor security issue | Fix when convenient |
| **INFO** | Informational finding | No action required |

### Finding Fields

- **timestamp**: When finding was discovered
- **tool**: Which Scorpion tool found it
- **severity**: Risk level (critical/high/medium/low/info)
- **category**: Type of vulnerability (web_application, ssl_tls, etc.)
- **description**: Human-readable description
- **details**: Technical details (JSON object)
- **exploitation_potential**: How exploitable (critical/high/medium/low)
- **recommended_action**: What to do about it

---

## Best Practices

### 1. Always Get Authorization

‚úÖ **DO:**
- Obtain written authorization before testing
- Define scope clearly (which systems, what actions)
- Establish rules of engagement
- Document authorization

‚ùå **DON'T:**
- Test without permission
- Assume verbal authorization is enough
- Exceed defined scope
- Test production systems without approval

### 2. Start Conservative

**First Run:**
```bash
scorpion ai-pentest -t example.com \
  --risk-tolerance low \
  --autonomy supervised \
  --time-limit 30
```

**Why:**
- Learn how the AI behaves
- Understand what tools it uses
- Verify safety controls work
- Build confidence

**Then Scale Up:**
```bash
scorpion ai-pentest -t example.com \
  --risk-tolerance medium \
  --autonomy semi_autonomous \
  --time-limit 90
```

### 3. Use Appropriate Stealth

**Production Systems:**
```bash
--stealth-level high --time-limit 180
```

**Internal/Lab Systems:**
```bash
--stealth-level low --time-limit 30
```

### 4. Monitor Costs

**AI API costs can add up quickly:**

| Model | Cost per Test | Quality |
|-------|---------------|---------|
| GPT-3.5-turbo | $0.10-0.50 | Good |
| GPT-4 | $1.00-5.00 | Excellent |
| Claude 3 Opus | $2.00-10.00 | Excellent |

**Cost Control:**
- Use `--max-iterations` to limit AI queries
- Use `--time-limit` to cap duration
- Use cheaper models for initial testing
- Consider local models for unlimited testing

### 5. Review Results Carefully

**Don't Blindly Trust AI:**
- Verify findings manually
- False positives can occur
- AI reasoning may be flawed
- Security expertise still required

### 6. Combine with Manual Testing

AI pentesting is a **tool**, not a replacement for human expertise.

**Best Approach:**
1. Run AI pentest for broad coverage
2. Review findings
3. Manually verify interesting results
4. Perform deep-dive manual testing
5. Use AI to fill gaps

### 7. Use Learning Mode (Future)

```bash
scorpion ai-pentest -t example.com --learning-mode
```

**Benefits:**
- AI learns from successful strategies
- Improves over time
- Adapts to your testing style

**Note:** Learning mode coming in v2.2.0

---

## Troubleshooting

### Error: "AI API key required"

**Problem:** No API key provided

**Solutions:**
```bash
# Option 1: Environment variable
export SCORPION_AI_API_KEY='sk-...'

# Option 2: Command line flag
scorpion ai-pentest -t example.com --api-key sk-...
```

---

### Error: "AI provider error: 401 Unauthorized"

**Problem:** Invalid or expired API key

**Solutions:**
1. Verify API key is correct
2. Check if key is expired
3. Verify account has credits/billing
4. Test key with provider's test endpoint

---

### Error: "AI provider error: 429 Rate Limit"

**Problem:** Too many API requests

**Solutions:**
1. Wait and retry
2. Increase `--time-limit` (slower pacing)
3. Reduce `--max-iterations`
4. Upgrade API plan
5. Use different provider

---

### Error: "SYN scan requires admin/root privileges"

**Problem:** Not running with sufficient privileges

**Solutions:**
```bash
# Linux/Mac
sudo scorpion ai-pentest -t example.com

# Windows (Run PowerShell as Administrator)
scorpion ai-pentest -t example.com
```

**Alternative:** AI will skip SYN scan and use TCP connect scan

---

### AI Keeps Trying Same Tool

**Problem:** AI stuck in loop

**Solutions:**
1. Interrupt test (Ctrl+C)
2. Reduce `--max-iterations`
3. Use more specific `--primary-goal`
4. Add `--secondary-goals` for guidance
5. Try different AI model

---

### Test Taking Too Long

**Problem:** Exceeding expected duration

**Solutions:**
```bash
# Reduce time limit
--time-limit 30

# Reduce max iterations
--max-iterations 5

# Lower stealth level
--stealth-level low

# Use faster model
--model gpt-3.5-turbo
```

---

### No Findings Returned

**Possible Reasons:**
1. Target is secure (good!)
2. Target is unreachable/down
3. Firewall blocking scans
4. Wrong target specification
5. Insufficient time/iterations

**Debugging:**
```bash
# Check if target is reachable
ping example.com

# Run simple port scan first
scorpion scan -t example.com --ports 80,443

# Increase time and iterations
scorpion ai-pentest -t example.com --time-limit 120 --max-iterations 15
```

---

## API Provider Details

### OpenAI

**Endpoint:** `https://api.openai.com/v1/chat/completions`

**Authentication:** Bearer token in `Authorization` header

**Models:**
- `gpt-4` - Best quality
- `gpt-4-turbo` - Fast and capable
- `gpt-3.5-turbo` - Budget option

**Pricing (as of Dec 2025):**
- GPT-4: $0.03/1K input tokens, $0.06/1K output tokens
- GPT-4 Turbo: $0.01/1K input tokens, $0.03/1K output tokens
- GPT-3.5 Turbo: $0.0015/1K input tokens, $0.002/1K output tokens

**Rate Limits:**
- Free tier: 3 requests/minute
- Paid tier: 90 requests/minute (Tier 1)

**Setup:**
```bash
export SCORPION_AI_API_KEY='sk-...'
scorpion ai-pentest -t example.com --model gpt-4
```

---

### Anthropic Claude

**Endpoint:** `https://api.anthropic.com/v1/messages`

**Authentication:** `x-api-key` header

**Models:**
- `claude-3-opus-20240229` - Highest capability
- `claude-3-sonnet-20240229` - Balanced
- `claude-3-haiku-20240307` - Fast & economical

**Pricing (as of Dec 2025):**
- Opus: $15/1M input tokens, $75/1M output tokens
- Sonnet: $3/1M input tokens, $15/1M output tokens
- Haiku: $0.25/1M input tokens, $1.25/1M output tokens

**Rate Limits:**
- Default: 50 requests/minute

**Setup:**
```bash
export SCORPION_AI_API_KEY='sk-ant-...'
scorpion ai-pentest -t example.com \
  --ai-provider anthropic \
  --model claude-3-opus-20240229
```

---

### Custom / Local Models

**Compatible With:**
- Ollama
- LM Studio
- LocalAI
- Text Generation WebUI
- Any OpenAI-compatible API

**Setup (Ollama Example):**

1. Install Ollama:
```bash
# Linux/Mac
curl https://ollama.ai/install.sh | sh

# Windows
# Download from ollama.ai
```

2. Pull model:
```bash
ollama pull llama3
```

3. Run Scorpion:
```bash
scorpion ai-pentest -t example.com \
  --ai-provider custom \
  --api-endpoint http://localhost:11434/v1/chat/completions \
  --api-key local \
  --model llama3
```

**Advantages:**
- ‚úÖ Free (no API costs)
- ‚úÖ Private (no data sent externally)
- ‚úÖ Unlimited usage
- ‚úÖ Offline capability

**Disadvantages:**
- ‚ùå Requires powerful hardware
- ‚ùå Lower quality than GPT-4/Claude
- ‚ùå Slower response times

---

## Cost Considerations

### Typical Test Costs

| Test Type | Iterations | Model | Est. Cost |
|-----------|-----------|-------|-----------|
| Quick scan | 5 | GPT-3.5 | $0.10-0.30 |
| Standard assessment | 10 | GPT-3.5 | $0.30-0.80 |
| Comprehensive | 10 | GPT-4 | $1.50-3.00 |
| Deep assessment | 20 | GPT-4 | $3.00-8.00 |
| Enterprise test | 20 | Claude Opus | $5.00-15.00 |

### Cost Optimization Tips

1. **Start with cheaper models:**
   ```bash
   --model gpt-3.5-turbo
   ```

2. **Limit iterations:**
   ```bash
   --max-iterations 5
   ```

3. **Set time limits:**
   ```bash
   --time-limit 30
   ```

4. **Use local models for testing:**
   ```bash
   --ai-provider custom --api-endpoint http://localhost:11434/v1/chat/completions
   ```

5. **Run targeted goals:**
   ```bash
   --primary-goal network_mapping  # Faster than comprehensive
   ```

---

## Limitations

### Current Limitations

1. **AI Quality Dependent**
   - Better models = better decisions
   - Cheaper models may miss nuances
   - Local models often inferior

2. **Token Limits**
   - Large findings may exceed context window
   - Agent summarizes to fit limits
   - Some details may be lost

3. **Cost Considerations**
   - API costs can add up
   - Long tests = more expensive
   - Enterprise use requires budget

4. **Not True AGI**
   - AI follows patterns, doesn't "understand"
   - Can make mistakes
   - Requires human verification

5. **Tool Limitations**
   - AI can only use available Scorpion tools
   - Can't install new tools mid-test
   - Some techniques not available

### Future Improvements (Roadmap)

**Version 2.2.0 (Q1 2026):**
- ‚ú® Learning mode (AI learns from successful strategies)
- ‚ú® Multi-target orchestration
- ‚ú® Custom tool integration
- ‚ú® Advanced chain-of-thought reasoning

**Version 2.3.0 (Q2 2026):**
- ‚ú® Collaborative AI (multiple AI agents)
- ‚ú® Automated remediation suggestions
- ‚ú® Integration with ticketing systems
- ‚ú® Continuous testing mode

---

## FAQ

### Q: Is AI pentesting as good as manual testing?

**A:** No. AI pentesting is a powerful tool, but NOT a replacement for skilled human testers. Use it to:
- Automate routine testing
- Cover broad attack surface quickly
- Identify low-hanging fruit
- Free up humans for complex manual testing

Always combine AI with manual verification.

---

### Q: Can I use AI pentesting without any security knowledge?

**A:** Not recommended. You need:
- Understanding of penetration testing concepts
- Ability to interpret findings
- Knowledge to verify results
- Legal/ethical awareness

AI doesn't replace expertise.

---

### Q: Will this trigger IDS/IPS alerts?

**A:** Depends on stealth level:
- `--stealth-level low` - WILL trigger alerts
- `--stealth-level moderate` - MAY trigger alerts
- `--stealth-level high` - LESS LIKELY but still possible

No pentesting is 100% undetectable.

---

### Q: Can I test my employer's systems?

**A:** Only with explicit written authorization from appropriate authority (CTO, CISO, etc.). "My manager said it's okay" is NOT sufficient.

---

### Q: What if the AI generates a false positive?

**A:** False positives can occur. Always:
1. Manually verify findings
2. Test exploitability
3. Assess actual risk
4. Report with confidence level

Use AI as initial triage, not final verdict.

---

### Q: Can AI pentesting find 0-days?

**A:** Unlikely. AI is trained on known patterns and techniques. 0-day discovery requires:
- Deep manual analysis
- Reverse engineering
- Novel attack research
- Human creativity

AI excels at known vulnerabilities, not novel discoveries.

---

### Q: How private is my data?

**Depends on provider:**
- **OpenAI:** Data sent to OpenAI servers (see privacy policy)
- **Anthropic:** Data sent to Anthropic servers (see privacy policy)
- **Local models:** 100% private, no external communication

For sensitive tests, use local models.

---

### Q: Can I save money by running once and reusing results?

**A:** Each test is unique based on:
- Current findings
- Time elapsed
- AI decisions
- Target changes

Results are not reusable. Each run costs API calls.

---

### Q: What's the difference from regular Scorpion commands?

| Feature | Regular Commands | AI Pentest |
|---------|-----------------|------------|
| Execution | Manual, one at a time | Automated, orchestrated |
| Decision-making | Human chooses tools | AI chooses tools |
| Adaptation | Human adapts strategy | AI adapts strategy |
| Coverage | Depends on human | Systematic and goal-driven |
| Cost | Free | API costs |
| Speed | Depends on human | Consistent and autonomous |

---

### Q: Can I interrupt a running test?

**A:** Yes, press `Ctrl+C`. The agent will stop and save current progress.

---

### Q: Does this work on mobile apps or IoT devices?

**A:** Currently focused on network/web targets. Mobile/IoT support planned for future versions.

---

## Summary

AI-powered penetration testing is a **game-changer** for security assessments, but it requires:
- ‚úÖ Proper authorization
- ‚úÖ Understanding of the technology
- ‚úÖ Manual verification of results
- ‚úÖ Ethical usage
- ‚úÖ Budget for API costs (or local models)

**Best Use Cases:**
- Initial security assessments
- Broad vulnerability discovery
- Automated testing pipelines
- Red team reconnaissance
- Augmenting manual testing

**Not Suitable For:**
- Unauthorized testing
- Fully replacing human testers
- Finding novel 0-days
- Compliance as sole evidence
- Security research

---

## Additional Resources

- [Scorpion README](README.md)
- [Commands Reference](COMMANDS.md)
- [Web Pentesting Guide](WEB_PENTESTING_GUIDE.md)
- [OS Fingerprinting Guide](OS_FINGERPRINTING_GUIDE.md)
- [Payload Generation Guide](PAYLOAD_GENERATION_GUIDE.md)
- [Decoy Scanning Guide](DECOY_SCANNING_GUIDE.md)

---

## Support

**Issues/Questions:**
- GitHub Issues: https://github.com/Prince12sam/Scorpion/issues
- Documentation: https://github.com/Prince12sam/Scorpion

**Legal Notice:**
This tool is provided for authorized security testing only. The authors are not responsible for misuse or damage caused by this software. Users are solely responsible for obtaining proper authorization and complying with all applicable laws.

---

**Version:** 2.1.0  
**Last Updated:** December 10, 2025  
**Status:** ‚úÖ Production Ready
