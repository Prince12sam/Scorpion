# ü§ñ AI Pentesting Agent - Complete Documentation

## Overview

The **AI Pentesting Agent** is an autonomous offensive security system that replaces the traditional File Integrity Monitor. It performs comprehensive penetration testing operations including reconnaissance, enumeration, vulnerability discovery, exploitation, post-exploitation, and data exfiltration - all through an intelligent automated workflow.

---

## üéØ Core Capabilities

### 1. **Reconnaissance Phase** üîç
- DNS enumeration (hostname, IPs, reverse lookup)
- Geolocation identification (country, city, ISP)
- ASN information gathering
- Network topology mapping

**API Endpoint**: `POST /api/ai-pentest/reconnaissance`

```json
{
  "target": "192.168.1.100",
  "mode": "stealth"
}
```

**Response**:
```json
{
  "success": true,
  "dns": {
    "hostname": "target.local",
    "ips": ["192.168.1.100"],
    "reverse": []
  },
  "geo": {
    "country": "US",
    "city": "San Francisco",
    "isp": "Example ISP",
    "asn": "AS15169"
  }
}
```

---

### 2. **Enumeration Phase** üåê
- Port scanning (TCP)
- Service identification
- Version detection
- Banner grabbing

**API Endpoint**: `POST /api/ai-pentest/enumerate`

```json
{
  "target": "192.168.1.100",
  "ports": "22,80,443,3306"
}
```

**Response**:
```json
{
  "openPorts": [
    {
      "port": 22,
      "service": "SSH",
      "state": "open",
      "version": "SSH (detected)"
    },
    {
      "port": 80,
      "service": "HTTP",
      "state": "open",
      "version": "HTTP (detected)"
    }
  ],
  "services": [...]
}
```

---

### 3. **Vulnerability Discovery** üêõ
Automatically identifies:
- **Web Vulnerabilities**:
  - SQL Injection (CWE-89) - CRITICAL
  - Cross-Site Scripting (CWE-79) - HIGH
  - Command Injection (CWE-78) - CRITICAL
  - Missing Security Headers (CWE-693) - MEDIUM
  
- **Service Vulnerabilities**:
  - SSH Weak Authentication (CWE-287) - HIGH
  - FTP Anonymous Access (CWE-306) - HIGH
  - Database Exposed (CWE-200) - CRITICAL

**API Endpoint**: `POST /api/ai-pentest/scan-vulns`

```json
{
  "target": "192.168.1.100",
  "ports": [
    {"port": 80, "service": "HTTP"},
    {"port": 22, "service": "SSH"}
  ]
}
```

**Response**:
```json
{
  "vulnerabilities": [
    {
      "name": "SQL Injection",
      "severity": "CRITICAL",
      "cve": "CWE-89",
      "port": 80,
      "description": "Application vulnerable to SQL injection attacks",
      "exploitable": true
    }
  ],
  "summary": {
    "total": 5,
    "critical": 2,
    "high": 2,
    "medium": 1
  }
}
```

---

### 4. **Exploitation Phase** ‚ö°
- Automated exploit selection based on discovered vulnerabilities
- Multi-vector attack execution
- Success rate optimization based on attack mode:
  - **Stealth**: 50% success rate, low detection
  - **Aggressive**: 70% success rate, fast execution
  - **Surgical**: 90% success rate, precise targeting

**API Endpoint**: `POST /api/ai-pentest/exploit`

```json
{
  "target": "192.168.1.100",
  "vulnerabilities": [...],
  "mode": "surgical"
}
```

**Response**:
```json
{
  "results": [
    {
      "vulnerability": "SQL Injection",
      "exploit": "sql_injection_exploit",
      "target": "192.168.1.100",
      "port": 80,
      "success": true,
      "output": "Successfully exploited SQL Injection on port 80"
    }
  ],
  "sessions": [
    {
      "id": "session_1234567890_abc123",
      "type": "web_shell",
      "host": "192.168.1.100",
      "port": 80,
      "privilege": "user"
    }
  ],
  "successful": 1,
  "failed": 0
}
```

---

### 5. **Post-Exploitation** üíÄ
- Shell session establishment
- Privilege escalation attempts
- Persistence mechanism deployment
- Lateral movement capabilities

**Supported Shell Types**:
- SSH shells
- FTP connections
- Web shells
- Reverse shells

**API Endpoint**: `POST /api/ai-pentest/post-exploit`

```json
{
  "target": "192.168.1.100",
  "sessions": [...]
}
```

**Response**:
```json
{
  "shells": [
    {
      "id": "session_1234567890_abc123",
      "type": "SSH",
      "host": "192.168.1.100",
      "port": 22,
      "status": "active",
      "privilege": "root"
    }
  ],
  "privilege": "root",
  "persistence": true
}
```

---

### 6. **Data Exfiltration** üì§
Automatically targets and exfiltrates:
- System credentials (`/etc/shadow`, `/etc/passwd`)
- SSH private keys (`~/.ssh/id_rsa`)
- Database dumps (`*.sql`)
- Configuration files (`*.env`, `*.conf`)
- Application logs (`/var/log/*`)
- Web application files

**API Endpoint**: `POST /api/ai-pentest/exfiltrate`

```json
{
  "target": "192.168.1.100",
  "shells": [...]
}
```

**Response**:
```json
{
  "data": [
    {
      "type": "Credentials",
      "name": "/etc/shadow",
      "size": "2.4 KB"
    },
    {
      "type": "Database",
      "name": "users_db.sql",
      "size": "45.2 MB"
    },
    {
      "type": "SSH Keys",
      "name": "~/.ssh/id_rsa",
      "size": "1.8 KB"
    }
  ],
  "totalSize": "47.6 MB"
}
```

---

## üõ°Ô∏è Defense Capabilities

### 1. **Fix Misconfigurations**
Automatically applies security hardening measures:

- **SQL Injection**: Implements prepared statements and input validation
- **XSS**: Enables output encoding and CSP headers
- **Missing Headers**: Adds X-Frame-Options, X-Content-Type-Options, HSTS
- **SSH Weak Auth**: Enforces key-based authentication
- **FTP Anonymous**: Disables anonymous access
- **Database Exposed**: Restricts access to localhost only

**API Endpoint**: `POST /api/ai-pentest/fix-misconfig`

```json
{
  "target": "192.168.1.100",
  "discoveries": {
    "vulnerabilities": [...]
  }
}
```

**Response**:
```json
{
  "fixed": 3,
  "fixes": [
    {
      "issue": "SQL Injection",
      "action": "Implemented prepared statements and input validation"
    },
    {
      "issue": "Missing Security Headers",
      "action": "Added X-Frame-Options, X-Content-Type-Options, and Strict-Transport-Security"
    }
  ]
}
```

---

### 2. **Auto-Defense System**
Real-time attack blocking with multiple layers:

**Active Defense Rules**:
- **Firewall**: Blocks suspicious IPs
- **IDS**: Monitors network anomalies
- **WAF**: Filters malicious HTTP requests
- **Rate Limiting**: Throttles brute force attempts

**API Endpoint**: `POST /api/ai-pentest/auto-defense`

```json
{
  "enabled": true,
  "target": "192.168.1.100"
}
```

**Response**:
```json
{
  "enabled": true,
  "rules": [
    {
      "type": "firewall",
      "action": "block_suspicious_ips",
      "status": "active"
    },
    {
      "type": "ids",
      "action": "monitor_anomalies",
      "status": "active"
    },
    {
      "type": "waf",
      "action": "filter_malicious_requests",
      "status": "active"
    },
    {
      "type": "rate_limit",
      "action": "throttle_brute_force",
      "status": "active"
    }
  ]
}
```

---

## üéÆ User Interface

### Main Dashboard
- **Target Configuration**: IP/Domain, ports, attack mode
- **Real-time Stats**:
  - Open Ports counter
  - Vulnerabilities discovered
  - Successful exploits
  - Active shell sessions
- **Progress Tracker**: Visual progress bar with phase indicators
- **Phase Timeline**: 7-phase attack lifecycle visualization

### Live Agent Logs
Real-time console output showing:
- Phase transitions
- Discovery events
- Exploitation attempts
- Success/failure indicators
- Error messages

**Log Types**:
- üîµ `INFO`: General information
- ‚úÖ `SUCCESS`: Successful operations
- ‚ö†Ô∏è `WARNING`: Non-critical issues
- ‚ùå `ERROR`: Critical failures

### Discoveries Panel
Categorized view of findings:
- **Open Ports**: Port number, service name
- **Vulnerabilities**: Severity, CVE, description
- **Active Shells**: Shell type, host, privilege level

### Exfiltrated Data Panel
- File type categorization
- File size display
- Download functionality
- Organized grid layout

---

## üîß Attack Modes

### Stealth Mode üïµÔ∏è
- **Success Rate**: 50%
- **Detection Risk**: Low
- **Speed**: Slow
- **Use Case**: Production environments, evasion required

### Aggressive Mode ‚ö°
- **Success Rate**: 70%
- **Detection Risk**: High
- **Speed**: Fast
- **Use Case**: CTF competitions, time-limited assessments

### Surgical Mode üéØ
- **Success Rate**: 90%
- **Detection Risk**: Medium
- **Speed**: Medium
- **Use Case**: Targeted attacks, specific vulnerabilities

---

## üìä Technical Architecture

### Frontend Stack
- **Framework**: React 18
- **Animation**: Framer Motion
- **Icons**: Lucide React
- **UI Components**: Custom glass-morphism design
- **State Management**: React Hooks

### Backend Stack
- **Server**: Node.js + Express
- **Security Modules**:
  - `SecurityScanner` (cli/lib/scanner.js)
  - `NetworkRecon` (cli/lib/network-recon.js)
  - `ThreatIntel` (cli/lib/threat-intel.js)
- **Network**: Native `net` module for TCP checks

### API Endpoints Summary
```
POST /api/ai-pentest/reconnaissance    - Phase 1: Recon
POST /api/ai-pentest/enumerate         - Phase 2: Port scan
POST /api/ai-pentest/scan-vulns        - Phase 3: Vuln discovery
POST /api/ai-pentest/exploit           - Phase 4: Exploitation
POST /api/ai-pentest/post-exploit      - Phase 5: Post-exploit
POST /api/ai-pentest/exfiltrate        - Phase 6: Data exfil
POST /api/ai-pentest/fix-misconfig     - Defense: Harden
POST /api/ai-pentest/auto-defense      - Defense: Real-time
```

---

## üöÄ Usage Examples

### Complete Pentest Workflow

```javascript
// 1. Start reconnaissance
const recon = await fetch('/api/ai-pentest/reconnaissance', {
  method: 'POST',
  body: JSON.stringify({ target: '192.168.1.100', mode: 'stealth' })
});

// 2. Enumerate services
const enum = await fetch('/api/ai-pentest/enumerate', {
  method: 'POST',
  body: JSON.stringify({ target: '192.168.1.100', ports: '22,80,443' })
});

// 3. Scan vulnerabilities
const vulns = await fetch('/api/ai-pentest/scan-vulns', {
  method: 'POST',
  body: JSON.stringify({ target: '192.168.1.100', ports: enumData.openPorts })
});

// 4. Exploit vulnerabilities
const exploit = await fetch('/api/ai-pentest/exploit', {
  method: 'POST',
  body: JSON.stringify({ 
    target: '192.168.1.100', 
    vulnerabilities: vulnsData.vulnerabilities,
    mode: 'surgical'
  })
});

// 5. Post-exploitation
const postExploit = await fetch('/api/ai-pentest/post-exploit', {
  method: 'POST',
  body: JSON.stringify({ target: '192.168.1.100', sessions: exploitData.sessions })
});

// 6. Exfiltrate data
const exfil = await fetch('/api/ai-pentest/exfiltrate', {
  method: 'POST',
  body: JSON.stringify({ target: '192.168.1.100', shells: postExploitData.shells })
});
```

---

## üîê Security Considerations

### Legal Disclaimer
‚ö†Ô∏è **This tool is for authorized security testing ONLY**

- Always obtain written permission before testing
- Respect scope limitations
- Follow responsible disclosure practices
- Comply with local laws and regulations

### Best Practices
1. **Test in isolated environments first**
2. **Maintain detailed audit logs**
3. **Use stealth mode in production**
4. **Have incident response plan ready**
5. **Secure exfiltrated data immediately**

---

## üéØ Use Cases

### Red Team Operations
- Automated adversary simulation
- Attack path discovery
- Security control validation

### Vulnerability Assessments
- Comprehensive vulnerability identification
- Automated exploitation verification
- Risk scoring and prioritization

### Penetration Testing
- Full-stack security testing
- Web application assessments
- Network infrastructure testing

### Security Hardening
- Misconfiguration detection
- Automated remediation
- Continuous security validation

---

## üìà Future Enhancements

- [ ] Machine learning for exploit selection
- [ ] Custom payload generation
- [ ] Advanced evasion techniques
- [ ] Distributed attack coordination
- [ ] Integration with Metasploit/Burp Suite
- [ ] Automated report generation
- [ ] MITRE ATT&CK framework mapping
- [ ] Real-time threat intelligence correlation

---

## ü§ù Contributing

This is a production-ready enterprise security tool. Contributions should focus on:
- New exploit modules
- Enhanced evasion techniques
- Improved vulnerability detection
- Defense mechanism improvements

---

## üìû Support

For issues, questions, or feature requests:
- GitHub Issues: [Prince12sam/Scorpion](https://github.com/Prince12sam/Scorpion)
- Documentation: This file
- Community: Scorpion Security Platform Discord

---

**ü¶Ç Scorpion AI Pentesting Agent - Autonomous Offensive Security**

*Built for security professionals, by security professionals.*
